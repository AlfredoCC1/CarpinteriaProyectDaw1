<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contacto | Carpinter√≠a Art&Wood</title>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">

    <!-- AOS Animations -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css" rel="stylesheet">

    <!-- CSS global + fragments -->
    <link rel="stylesheet" th:href="@{/css/global.css}">
    <link rel="stylesheet" th:href="@{/css/fragments/navbar.css}">
    <link rel="stylesheet" th:href="@{/css/fragments/desplazate.css}">
    <link rel="stylesheet" th:href="@{/css/fragments/footer.css}">

    <!-- CSS page -->
    <link rel="stylesheet" th:href="@{/css/contacto.css}">
</head>

<body>
<!-- NAVBAR -->
<div th:replace="~{fragments/navbar :: mainNavbar}"></div>

<!-- HERO -->
<header class="contact-hero">
    <div class="container">
        <div class="hero-badge mb-3" data-aos="fade-down">
            <i class="fa-solid fa-envelope-open-text"></i>
            <span>Resolvemos tus dudas y cotizamos tu proyecto</span>
        </div>

        <h1 class="hero-title mb-2" data-aos="fade-up">Contacto</h1>
        <p class="lead hero-subtitle mb-4" data-aos="fade-up" data-aos-delay="100">
            Cu√©ntanos qu√© necesitas y te respondemos con una propuesta clara:
            materiales, tiempos y costo estimado.
        </p>

        <div class="d-flex flex-wrap justify-content-center gap-2" data-aos="fade-up" data-aos-delay="200">
            <a href="/" class="btn btn-soft-outline btn-outline-light d-inline-flex align-items-center gap-2">
                <i class="fa-solid fa-house"></i> Volver al inicio
            </a>

            <!-- WhatsApp: cambia el n√∫mero -->
            <a class="btn btn-main" id="btnWhatsHero" target="_blank" rel="noopener">
                <i class="fa-brands fa-whatsapp"></i> WhatsApp directo
            </a>
        </div>
    </div>

    <div class="scroll-indicator d-none d-md-flex">
        <span>Despl√°zate</span>
        <div class="scroll-indicator-dot"></div>
    </div>
</header>

<!-- CANALES + FORM -->
<section class="section-soft">
    <div class="container">
        <div class="row g-4 align-items-stretch">

            <!-- Col izquierda -->
            <div class="col-lg-5" data-aos="fade-right">
                <div class="glass-card h-100">
                    <div class="pill mb-2">
                        <i class="fa-solid fa-headset"></i> Canales r√°pidos
                    </div>
                    <h2 class="section-title mb-2">Hablemos hoy</h2>
                    <p class="section-subtitle mb-3">
                        Elige el canal que prefieras. Tambi√©n puedes dejarnos tus datos y te contactamos.
                    </p>

                    <div class="channel-grid">
                        <a class="channel-card" id="btnWhatsCard" target="_blank" rel="noopener">
                            <div class="cc-icon"><i class="fa-brands fa-whatsapp"></i></div>
                            <div class="cc-text">
                                <strong>WhatsApp</strong>
                                <span>Respuesta m√°s r√°pida</span>
                            </div>
                            <i class="fa-solid fa-arrow-right-long cc-arrow"></i>
                        </a>

                        <a class="channel-card" href="mailto:contacto@artwood.pe">
                            <div class="cc-icon"><i class="fa-solid fa-at"></i></div>
                            <div class="cc-text">
                                <strong>Email</strong>
                                <span>contacto@artwood.pe</span>
                            </div>
                            <i class="fa-solid fa-arrow-right-long cc-arrow"></i>
                        </a>

                        <a class="channel-card" href="tel:+51999999999">
                            <div class="cc-icon"><i class="fa-solid fa-phone"></i></div>
                            <div class="cc-text">
                                <strong>Llamada</strong>
                                <span>+51 999 999 999</span>
                            </div>
                            <i class="fa-solid fa-arrow-right-long cc-arrow"></i>
                        </a>

                        <div class="channel-card channel-static">
                            <div class="cc-icon"><i class="fa-solid fa-location-dot"></i></div>
                            <div class="cc-text">
                                <strong>Zona de atenci√≥n</strong>
                                <span>Lima (seg√∫n evaluaci√≥n)</span>
                            </div>
                        </div>
                    </div>

                    <div class="divider my-3"></div>

                    <div class="small text-muted">
                        <strong>Horario:</strong> Lun‚ÄìS√°b 9:00am‚Äì6:00pm <br>
                        <span class="badge-soft mt-2 d-inline-flex align-items-center gap-2">
              <i class="fa-solid fa-shield-halved"></i>
              Cotizaci√≥n transparente, sin sorpresas
            </span>
                    </div>
                </div>
            </div>

            <!-- Col derecha: Form + preview -->
            <div class="col-lg-7" data-aos="fade-left">
                <div class="form-shell">
                    <div class="form-head">
                        <div>
                            <h3 class="mb-1">Env√≠anos tu solicitud</h3>
                            <p class="small text-muted mb-0">
                                Completa el formulario. Mientras escribes, ver√°s un resumen para que todo quede claro.
                            </p>
                        </div>
                        <div class="step-chip">
                            <i class="fa-solid fa-list-check"></i> 1/1
                        </div>
                    </div>

                    <div class="row g-3">
                        <!-- FORM -->
                        <div class="col-12 col-xl-7">
                            <form id="contactForm" class="needs-validation" novalidate>

                                <div class="row g-3">
                                    <div class="col-12">
                                        <label class="form-label">Nombre completo</label>
                                        <div class="input-icon">
                                            <i class="fa-solid fa-user"></i>
                                            <input type="text" class="form-control" id="name" placeholder="Ej: Alfredo Castro" required>
                                        </div>
                                        <div class="invalid-feedback">Por favor, ingresa tu nombre.</div>
                                    </div>

                                    <div class="col-md-6">
                                        <label class="form-label">Tel√©fono / WhatsApp</label>
                                        <div class="input-icon">
                                            <i class="fa-solid fa-phone"></i>
                                            <input type="tel" class="form-control" id="phone" placeholder="Ej: 999 999 999" required>
                                        </div>
                                        <div class="invalid-feedback">Ingresa tu n√∫mero (para coordinar medidas).</div>
                                    </div>

                                    <div class="col-md-6">
                                        <label class="form-label">Email</label>
                                        <div class="input-icon">
                                            <i class="fa-solid fa-envelope"></i>
                                            <input type="email" class="form-control" id="email" placeholder="Ej: correo@gmail.com" required>
                                        </div>
                                        <div class="invalid-feedback">Ingresa un email v√°lido.</div>
                                    </div>

                                    <div class="col-md-6">
                                        <label class="form-label">Servicio</label>
                                        <select class="form-select" id="service" required>
                                            <option value="" selected disabled>Selecciona una opci√≥n</option>
                                            <option value="Mobiliario a medida">Mobiliario a medida</option>
                                            <option value="Cocinas y closets">Cocinas y closets</option>
                                            <option value="Restauraci√≥n">Restauraci√≥n</option>
                                            <option value="Otro / Asesor√≠a">Otro / Asesor√≠a</option>
                                        </select>
                                        <div class="invalid-feedback">Selecciona el servicio.</div>
                                    </div>

                                    <div class="col-md-6">
                                        <label class="form-label">Distrito (referencia)</label>
                                        <div class="input-icon">
                                            <i class="fa-solid fa-map-pin"></i>
                                            <input type="text" class="form-control" id="district" placeholder="Ej: San Miguel" required>
                                        </div>
                                        <div class="invalid-feedback">Indica tu distrito.</div>
                                    </div>

                                    <div class="col-12">
                                        <label class="form-label">¬øQu√© necesitas?</label>
                                        <textarea class="form-control" id="message" rows="5"
                                                  placeholder="Ej: Closet empotrado 2.40m x 2.60m, puertas corredizas, color nogal..."
                                                  maxlength="600" required></textarea>
                                        <div class="d-flex justify-content-between mt-1">
                                            <div class="invalid-feedback d-block" id="msgError" style="display:none;">
                                                Describe tu proyecto con un poco m√°s de detalle.
                                            </div>
                                            <div class="char-counter"><span id="charCount">0</span>/600</div>
                                        </div>
                                    </div>

                                    <div class="col-12">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="" id="consent" required>
                                            <label class="form-check-label small" for="consent">
                                                Acepto que me contacten para coordinar la cotizaci√≥n.
                                            </label>
                                            <div class="invalid-feedback">Debes aceptar para continuar.</div>
                                        </div>
                                    </div>

                                    <div class="col-12 d-flex flex-wrap gap-2">
                                        <button class="btn btn-main" type="submit">
                                            <i class="fa-solid fa-paper-plane"></i> Enviar
                                        </button>

                                        <button class="btn btn-outline-dark btn-soft-outline" type="button" id="btnSendWhats">
                                            <i class="fa-brands fa-whatsapp"></i> Enviar por WhatsApp
                                        </button>

                                        <button class="btn btn-outline-secondary btn-soft-outline" type="button" id="btnClear">
                                            <i class="fa-solid fa-eraser"></i> Limpiar
                                        </button>
                                    </div>
                                </div>
                            </form>

                            <div class="mini-note mt-3">
                                <i class="fa-solid fa-circle-info"></i>
                                Tip: Si tienes fotos o referencias, env√≠alas por WhatsApp para cotizar m√°s r√°pido.
                            </div>
                        </div>

                        <!-- PREVIEW -->
                        <div class="col-12 col-xl-5">
                            <div class="preview-card">
                                <div class="pill mb-2"><i class="fa-solid fa-file-lines"></i> Resumen</div>
                                <div class="preview-row">
                                    <span>Nombre</span><strong id="pvName">‚Äî</strong>
                                </div>
                                <div class="preview-row">
                                    <span>Tel√©fono</span><strong id="pvPhone">‚Äî</strong>
                                </div>
                                <div class="preview-row">
                                    <span>Email</span><strong id="pvEmail">‚Äî</strong>
                                </div>
                                <div class="preview-row">
                                    <span>Servicio</span><strong id="pvService">‚Äî</strong>
                                </div>
                                <div class="preview-row">
                                    <span>Distrito</span><strong id="pvDistrict">‚Äî</strong>
                                </div>

                                <div class="preview-msg mt-3">
                                    <div class="small text-muted mb-1">Mensaje</div>
                                    <div id="pvMessage" class="pv-text">Escribe tu solicitud para ver el resumen aqu√≠.</div>
                                </div>

                                <div class="divider my-3"></div>

                                <div class="small text-muted">
                                    <i class="fa-solid fa-stopwatch me-1"></i>
                                    Tiempo estimado de respuesta: <strong>1‚Äì24h</strong> (seg√∫n carga del d√≠a).
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

        </div>
    </div>
</section>

<!-- MAP + FAQ -->
<section class="bg-white">
    <div class="container">
        <div class="row g-4 align-items-stretch">
            <div class="col-lg-6" data-aos="fade-right">
                <div class="highlight-box h-100">
                    <h4 class="mb-2"><i class="fa-solid fa-map-location-dot me-2 text-warning"></i>Mapa (referencial)</h4>
                    <p class="section-subtitle mb-3">
                        Puedes colocar aqu√≠ tu ubicaci√≥n o una zona general de atenci√≥n.
                    </p>

                    <div class="map-frame">
                        <!-- Cambia el src a tu direcci√≥n si quieres -->
                        <iframe
                                src="https://www.google.com/maps?q=Lima%20Peru&output=embed"
                                loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                    </div>

                    <div class="small text-muted mt-3">
                        <strong>Tip:</strong> Para medici√≥n a domicilio, coordinamos d√≠a y hora por WhatsApp.
                    </div>
                </div>
            </div>

            <div class="col-lg-6" data-aos="fade-left">
                <div class="highlight-box h-100">
                    <h4 class="mb-2"><i class="fa-solid fa-circle-question me-2 text-warning"></i>Preguntas frecuentes</h4>

                    <div class="accordion" id="faqAcc">
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">
                                    ¬øHacen visita para medir?
                                </button>
                            </h2>
                            <div id="faq1" class="accordion-collapse collapse show" data-bs-parent="#faqAcc">
                                <div class="accordion-body small">
                                    S√≠. Coordinamos una visita para medir y evaluar el espacio. Con eso, la propuesta queda exacta.
                                </div>
                            </div>
                        </div>

                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">
                                    ¬øCu√°nto demora un proyecto?
                                </button>
                            </h2>
                            <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAcc">
                                <div class="accordion-body small">
                                    Depende del tama√±o y materiales. Muchos proyectos se completan entre 2 y 4 semanas tras aprobaci√≥n.
                                </div>
                            </div>
                        </div>

                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq3">
                                    ¬øQu√© necesito para cotizar m√°s r√°pido?
                                </button>
                            </h2>
                            <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAcc">
                                <div class="accordion-body small">
                                    Medidas aproximadas, fotos del espacio, referencia del estilo y tu distrito. Con eso avanzamos r√°pido.
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="divider my-3"></div>

                    <div class="small text-muted">
                        <i class="fa-solid fa-shield-halved me-1"></i>
                        Trabajamos con materiales y herrajes de calidad. Si necesitas varias opciones,
                        te mandamos alternativas por rango de presupuesto.
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- CTA -->
<section>
    <div class="container">
        <div class="highlight-box text-center" data-aos="zoom-in">
            <h3 class="mb-2">¬øListo para tu mueble a medida?</h3>
            <p class="section-subtitle mb-3">
                Escr√≠benos y te asesoramos con dise√±o, materiales y una propuesta clara.
            </p>
            <a class="btn btn-main me-2 mb-2" id="btnWhatsCTA" target="_blank" rel="noopener">
                <i class="fa-brands fa-whatsapp"></i> Hablar por WhatsApp
            </a>
            <a href="/productos" class="btn btn-outline-dark btn-soft-outline mb-2">
                <i class="fa-solid fa-chair"></i> Ver cat√°logo
            </a>
        </div>
    </div>
</section>

<!-- FOOTER -->
<div th:replace="~{fragments/footer :: mainFooter}"></div>

<!-- TOAST -->
<div class="toast-container position-fixed top-0 end-0 p-3">
    <div id="okToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header">
            <i class="fa-solid fa-circle-check me-2 text-success"></i>
            <strong class="me-auto">Solicitud lista</strong>
            <small>Art&Wood</small>
            <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
        <div class="toast-body">
            ¬°Perfecto! Tu mensaje est√° listo. Si deseas, env√≠alo tambi√©n por WhatsApp para respuesta r√°pida.
        </div>
    </div>
</div>

<!-- JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>

<script>
    AOS.init({ duration: 700, once: true });

    // ========= CONFIG =========
    // Cambia a tu n√∫mero real: +51XXXXXXXXX (sin espacios)
    const WHATS_NUMBER = "51999999999";

    // Links de WhatsApp
    function buildWhatsLink(text){
        return `https://wa.me/${WHATS_NUMBER}?text=${encodeURIComponent(text)}`;
    }

    const heroWhats = document.getElementById("btnWhatsHero");
    const cardWhats = document.getElementById("btnWhatsCard");
    const ctaWhats  = document.getElementById("btnWhatsCTA");

    const defaultText = "Hola Art&Wood, quiero una cotizaci√≥n. ¬øPodemos coordinar?";
    [heroWhats, cardWhats, ctaWhats].forEach(btn => btn && (btn.href = buildWhatsLink(defaultText)));

    // ========= PREVIEW EN VIVO =========
    const $ = (id) => document.getElementById(id);

    const fields = {
        name: $("name"),
        phone: $("phone"),
        email: $("email"),
        service: $("service"),
        district: $("district"),
        message: $("message")
    };

    const preview = {
        name: $("pvName"),
        phone: $("pvPhone"),
        email: $("pvEmail"),
        service: $("pvService"),
        district: $("pvDistrict"),
        message: $("pvMessage"),
        char: $("charCount")
    };

    function syncPreview(){
        preview.name.textContent = fields.name.value.trim() || "‚Äî";
        preview.phone.textContent = fields.phone.value.trim() || "‚Äî";
        preview.email.textContent = fields.email.value.trim() || "‚Äî";
        preview.service.textContent = fields.service.value || "‚Äî";
        preview.district.textContent = fields.district.value.trim() || "‚Äî";

        const msg = fields.message.value.trim();
        preview.message.textContent = msg || "Escribe tu solicitud para ver el resumen aqu√≠.";
        preview.char.textContent = fields.message.value.length;
    }

    Object.values(fields).forEach(el => el.addEventListener("input", syncPreview));
    fields.service.addEventListener("change", syncPreview);
    syncPreview();

    // ========= VALIDACI√ìN + TOAST =========
    const form = $("contactForm");
    const toastEl = $("okToast");
    const okToast = toastEl ? new bootstrap.Toast(toastEl, { delay: 3500 }) : null;

    form.addEventListener("submit", (e) => {
        e.preventDefault();
        e.stopPropagation();

        const msg = fields.message.value.trim();
        const msgError = $("msgError");

        if(msg.length < 12){
            msgError.style.display = "block";
            fields.message.classList.add("is-invalid");
        }else{
            msgError.style.display = "none";
            fields.message.classList.remove("is-invalid");
        }

        if(form.checkValidity() && msg.length >= 12){
            okToast && okToast.show();
            // Aqu√≠ podr√≠as hacer fetch() a tu backend si luego lo conectas
        }

        form.classList.add("was-validated");
    });

    // ========= BOT√ìN ENVIAR WHATSAPP =========
    function buildSummary(){
        const lines = [
            "Hola Art&Wood üëã, quiero una cotizaci√≥n:",
            "",
            `Nombre: ${fields.name.value.trim() || "-"}`,
            `Tel√©fono: ${fields.phone.value.trim() || "-"}`,
            `Email: ${fields.email.value.trim() || "-"}`,
            `Servicio: ${fields.service.value || "-"}`,
            `Distrito: ${fields.district.value.trim() || "-"}`,
            "",
            "Detalle:",
            `${fields.message.value.trim() || "-"}`
        ];
        return lines.join("\n");
    }

    $("btnSendWhats").addEventListener("click", () => {
        // forzamos validaci√≥n m√≠nima antes de enviar
        form.classList.add("was-validated");
        if(!fields.name.value.trim() || !fields.phone.value.trim() || !fields.email.value.trim() ||
            !fields.service.value || !fields.district.value.trim() || fields.message.value.trim().length < 12){
            okToast && okToast.show(); // igual muestra gu√≠a
            return;
        }
        window.open(buildWhatsLink(buildSummary()), "_blank");
    });

    // ========= LIMPIAR =========
    $("btnClear").addEventListener("click", () => {
        form.reset();
        form.classList.remove("was-validated");
        $("msgError").style.display = "none";
        syncPreview();

        // restaurar links a texto default
        [heroWhats, cardWhats, ctaWhats].forEach(btn => btn && (btn.href = buildWhatsLink(defaultText)));
    });

    // Actualiza links de WhatsApp con un texto personalizado mientras escribe
    function updateWhatsDynamic(){
        const custom = buildSummary();
        [heroWhats, cardWhats, ctaWhats].forEach(btn => btn && (btn.href = buildWhatsLink(custom)));
    }
    ["input","change"].forEach(evt => form.addEventListener(evt, updateWhatsDynamic));
</script>

</body>
</html>
